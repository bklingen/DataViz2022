library(tidyverse)
library(ggplot2)
library(usethis)
library(devtools)
library(chorddiag)
library(RColorBrewer)
alumns <- read.csv(file="./data/NCAlumn.csv")
alumns <- read.csv(file="../data/NCAlumn.csv")
#dim(alumns)
colnames(alumns)
head(alumns)
library(tidyverse)
library(ggplot2)
library(usethis)
library(devtools)
library(chorddiag)
library(RColorBrewer)
alumns <- read.csv(file="../data/NCAlumn.csv")
#dim(alumns)
colnames(alumns)
head(alumns)
# Recoded factors
aoc.recoded <- alumns$ACADEMIC_PROGRAM_1 %>% fct_lump(prop=0.01)
industry.recoded <- fct_lump(alumns$Industry, n=7)
alumns.recoded <- alumns %>% mutate(Industry = industry.recoded, aoc = aoc.recoded)
# Computation
data.aoc <- alumns.recoded %>%
drop_na(aoc, Industry) %>%
select(aoc, Industry) %>%
mutate(Industry=fct_infreq(Industry)) %>%
filter(Industry != "Other")
as.matrix(table(data.aoc))
# Recoded factors
division_1 <- alumns$DIVISION_1
industry.recoded <- fct_lump(alumns$Industry, n=7)
alumns.recoded <- alumns %>% mutate(Industry = industry.recoded)
# Computation
data.division <- alumns.recoded %>%
drop_na(DIVISION_1, Industry) %>%
select(DIVISION_1, Industry) %>%
filter(Industry != 'Other' & Industry != '') %>%
filter(DIVISION_1 != '') %>%
mutate(Industry = droplevels(Industry))
as.matrix(table(data.division))
unique(data.division$Industry)
dataplot <- as.matrix(table(data.division))
dim(as.matrix(dataplot))
dataplot
# Number of divisions
num.divisions = length(rownames(dataplot))
# Data/matrix to be plotted
m <- as.matrix(dataplot)
m_transpose<- t(m)
division <- rownames(dataplot)
industry <- colnames(dataplot)
dimnames(m_transpose) <- list(industry = industry,
division = division)
# Color scheme
mycols <- brewer.pal(num.divisions ,'Set2')[1:4]
divisionColors <- mycols
industryColors <- rep('grey', length(industry))
colors <- c(industryColors, divisionColors)
chorddiag(m_transpose, groupColors = colors, showTicks = F, groupnamePadding = 20, type='bipartite', groupThickness = 0.1)
?chorddiag
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05)
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
showTicks = F)
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
showTicks = F)
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
groupnameFontsize = 10,
showTicks = F)
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
groupnameFontsize = 15,
showTicks = F)
# Recoded factors
aoc.recoded <- alumns$ACADEMIC_PROGRAM_1 %>% fct_lump(prop=0.01)
industry.recoded <- fct_lump(alumns$Industry, n=7)
alumns.recoded <- alumns %>% mutate(Industry = industry.recoded, aoc = aoc.recoded)
# Computation
data.aoc <- alumns.recoded %>%
drop_na(aoc, Industry) %>%
select(aoc, Industry) %>%
mutate(Industry=Industry) %>%
filter(Industry != "Other")
as.matrix(table(data.aoc))
# Recoded factors
division_1 <- alumns$DIVISION_1
industry.recoded <- fct_lump(alumns$Industry, n=7)
alumns.recoded <- alumns %>% mutate(Industry = industry.recoded)
# Computation
data.division <- alumns.recoded %>%
drop_na(DIVISION_1, Industry) %>%
select(DIVISION_1, Industry) %>%
filter(Industry != 'Other' & Industry != '') %>%
filter(DIVISION_1 != '') %>%
mutate(Industry = droplevels(Industry))
as.matrix(table(data.division))
unique(data.division$Industry)
dataplot <- as.matrix(table(data.division))
dim(as.matrix(dataplot))
dataplot
# Number of divisions
num.divisions = length(rownames(dataplot))
# Data/matrix to be plotted
m <- as.matrix(dataplot)
m_transpose<- t(m)
division <- rownames(dataplot)
industry <- colnames(dataplot)
dimnames(m_transpose) <- list(industry = industry,
division = division)
# Color scheme
mycols <- brewer.pal(num.divisions ,'Set2')[1:4]
divisionColors <- mycols
industryColors <- rep('grey', length(industry))
colors <- c(industryColors, divisionColors)
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
groupnameFontsize = 15,
showTicks = F)
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
groupnameFontsize = 15,
showTicks = F,
categoryNames = c('Academic Division', 'Industry'))
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
groupnameFontsize = 15,
showTicks = F,
categoryNames = c('Industry', 'Academic Division'))
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
groupnameFontsize = 15,
showTicks = F,
categoryNames = c('Industry', 'Academic Division'),
categorynamePadding = 20)
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
groupnameFontsize = 15,
showTicks = F,
categoryNames = c('Industry', 'Academic Division'),
categorynamePadding = 150)
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
groupnameFontsize = 15,
showTicks = F,
categoryNames = c('Industry', 'Academic Division'),
categorynamePadding = 150,
categorynameFontsize = 40)
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
groupnameFontsize = 15,
showTicks = F,
categoryNames = c('Industry', 'Academic Division'),
categorynamePadding = 150,
categorynameFontsize = 20)
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
groupnameFontsize = 15,
showTicks = F,
categoryNames = c('Industry', 'Academic Division'),
categorynamePadding = 150,
categorynameFontsize = 25)
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
groupnameFontsize = 15,
showTicks = F,
categoryNames = c('Industry', 'Academic Division'),
categorynamePadding = 150,
categorynameFontsize = 25,
fadeLevel = 0.1)
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
groupnameFontsize = 15,
showTicks = F,
categoryNames = c('Industry', 'Academic Division'),
categorynamePadding = 150,
categorynameFontsize = 25)
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
groupnameFontsize = 15,
showTicks = F,
categoryNames = c('Industry', 'Academic Division'),
categorynamePadding = 150,
categorynameFontsize = 25,
fadelevel = 1)
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
groupnameFontsize = 15,
showTicks = F,
categoryNames = c('Industry', 'Academic Division'),
categorynamePadding = 150,
categorynameFontsize = 25,
fadeLevel = 1)
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
groupnameFontsize = 15,
showTicks = F,
categoryNames = c('Industry', 'Academic Division'),
categorynamePadding = 150,
categorynameFontsize = 25,
fadeLevel = 0.5)
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
groupnameFontsize = 15,
showTicks = F,
categoryNames = c('Industry', 'Academic Division'),
categorynamePadding = 150,
categorynameFontsize = 25,
fadeLevel = 0.05)
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
groupnameFontsize = 15,
showTicks = F,
categoryNames = c('Industry', 'Academic Division'),
categorynamePadding = 150,
categorynameFontsize = 25,
fadeLevel = 0.2)
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
groupnameFontsize = 15,
showTicks = F,
categoryNames = c('Industry', 'Academic Division'),
categorynamePadding = 150,
categorynameFontsize = 25,
fadeLevel = 0.1)
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
groupnameFontsize = 15,
showTicks = F,
categoryNames = c('Industry', 'Academic Division'),
categorynamePadding = 150,
categorynameFontsize = 25,
fadeLevel = 0.05)
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
groupnameFontsize = 15,
showTicks = F,
categoryNames = c('Industry', 'Academic Division'),
categorynamePadding = 150,
categorynameFontsize = 25,
fadeLevel = 0.15)
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
groupnameFontsize = 15,
showTicks = F,
categoryNames = c('Industry', 'Academic Division'),
categorynamePadding = 150,
categorynameFontsize = 25,
fadeLevel = 0.1,
showZeroTooltips = 0)
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
groupnameFontsize = 15,
showTicks = F,
categoryNames = c('Industry', 'Academic Division'),
categorynamePadding = 150,
categorynameFontsize = 25,
fadeLevel = 0.1,
tooltipUnit = 'students')
chorddiag(data = m_transpose,
type='bipartite',
groupColors = colors,
groupThickness = 0.05,
groupnamePadding = 10,
groupnameFontsize = 15,
showTicks = F,
categoryNames = c('Industry', 'Academic Division'),
categorynamePadding = 150,
categorynameFontsize = 25,
fadeLevel = 0.1,
tooltipUnit = ' students')
